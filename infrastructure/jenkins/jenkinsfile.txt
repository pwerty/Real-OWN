pipeline {
    agent { label 'unity-builder' }
    environment {
        UNITY_LICENSE = credentials('UNITY_LICENSE')
    }
    stages {
        stage('Git Clone') {
            steps {
                git 'https://github.com/pwerty/Real-OWN.git'
            }
        }
        stage('Windows Build') {
            steps {
                container('unity-builder') {
                    // 유니티 6 윈도우 빌드 실행, BuildScript.cs 포함해야함.
                    sh "unity-editor -batchmode -nographics -projectPath . -executeMethod BuildScript.BuildWindows -quit -logfile /dev/stdout"
                }
            }
        }
    }
    post {
        success {
            // 빌드 성공 시 결과물(.exe)을 젠킨스 대시보드에서 다운로드 가능하게 보관
            archiveArtifacts artifacts: 'Builds/Windows/**', fingerprint: true
            echo "성공!"
        }
    }
}